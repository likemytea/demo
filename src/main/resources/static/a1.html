<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>a1</title>
<style type = "text/css">
#msg{
	display:none;
	position:absolute;
	background:gray;
	width:200px;
	height:300px;
	overflow:auto
}
.bg{
    background-color: gray;
}
.bg:hover{
    background-color: burlywood;
}
</style>

<script type="text/javascript" src="js/jquery-1.js"></script>
<script type="text/javascript">
function setDivHidden()
{
	 var addr=document.getElementById("msg")
	 addr.style.display = "none"; 
}
function getDivPosition(o)
{
	 var point=new Object();
	 point.x=o.offsetLeft;
	 point.y=o.offsetTop+o.offsetHeight;
	 while(o=o.offsetParent)
	 {
	  point.x+=o.offsetLeft;
	  point.y+=o.offsetTop;
	 }
	 var addr=document.getElementById("msg")
	 addr.style.left=point.x+"px";
	 addr.style.top=point.y+"px";
	 addr.style.display = "block";
}

function updateLi(thekey,theval){
	var ele = document.createElement('li');
	ele.innerHTML='<li id="'+thekey+'" class="bg">'+theval+'</li>';
	document.getElementById('msgul').appendChild(ele);
}

//鼠标键入事件
function flushCombo(){
	//清空层里边所有的li
	$("#msgul").find("li").remove();
	var input = document.getElementById('myinput').value;
	if(input==''){
		return;
	}
	var reg =  new RegExp(input);
	//获取原始数据
	var original = getOriginalData();
	//解析为数组
	var dataArray = JSON.parse(original);
	//遍历数组
	for (var i = 0, l = dataArray.length; i < l; i++) {
		var theval='';
		var thekey='';
	    for (var key in dataArray[i]) {
	    	//找到某一条里边的name
	    	if(key=='name'){
	    		//确定这个name是否满足搜索条件
	    		if(reg.test(dataArray[i][key])){
	    			theval = dataArray[i][key];
	    		}else{
		    		continue;
		    	}
	    		
	    	}
	    	//设置name对应的业务key
	    	if(key=='strVal'){
	    		thekey=dataArray[i][key];
	    	}
	    	//过滤掉没用的数据，因为执行到这里的还可能是数组中name前的key-value
	    	if(theval.length>0&&thekey.length>0){
	    		updateLi(thekey,theval);
	    	}
	    }
	}
}


function getOriginalData(){
	var a = '[{\"name\":\"全部\",\"selected\":\"true\"},{\"id\":\"1\",\"name\":\"核心企业\",\"selected\":\"false\",\"strVal\":\"01\"},{\"id\":\"2\",\"name\":\"借款企业\",\"selected\":\"false\",\"strVal\":\"02\"}]';
	return a;
}
</script>
</head>
<body>

--------------------------------------------------
<input type ="text" id ="myinput" oninput="flushCombo()" style="width:197px; height:20px;" placeholder="请输入关键词" onfocus="getDivPosition(this)" onfocusout="setDivHidden()"/>
<button onclick="updateLi()">点我就加Li</button>
<div id="msg">
	<ul id="msgul" style="list-style-type:none;padding:5px;margin:0;">
		<li class="bg">liu2yi1@test.com</li>
		<li class="bg">liu2er4@test.com</li>
		<li class="bg">zheng4ba1@test.com</li>
		<li class="bg">zheng4jiu3@test.com</li>
		<li class="bg">zheng4shi2@test.com</li>
	</ul>
</div>
</body>
</html>